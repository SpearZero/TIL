## 애플리케이션 계층

네트워크 계층은 복잡하기 때문에 추상화 시킴
- 계층 아래로 내려갈수록 구체화 된다.

가장 대표적인 애플리케이션 계층은 HTTP 기반의 웹 브라우저

네트워크 애플리케이션 - 운영체제 위에서 실행되는 하나의 프로세스들, 다른 프로세스들과 메시지를 주고받는 애플리케이션, OS의 기능을 가지고 다른 프로세스와 통신

애플리케이션 계층에만 집중
- 패킷이 어떻게 전송되고 유실되는지 신경 안써도 됨
- ex) 편지를 쓰고 우체통에 넣기만 알면되고 전달은 어떻게 되는지 몰라도 된다.

애플리케이션 아키텍처 예시
- 클라이언트 <-> 서버 구조
    - 클라이언트 
        - 서버와 통신한다.
        - 무언가 필요할 때 메시지만 요청 
        - 동적인 IP 주소를 가진다. 
        - 클라이언트 각각 직접적으로 통신하지 않음
    - 서버
        - 같은 장소에서 요청을 기다린다. 
        - 고정된 IP 주소를 가진다.

프로세스들간의 메시지 교환(IPC 이용)
- 네트워크 통신도 프로세스간의 통신이지만, 프로세스가 다른 머신에 있다는것만 차이가 있다.

클라이언트와 웹 서버가 통신이 가능한 이유는 OS에서 서비스를 제공하기 때문이다. 
- 소켓이라는 인터페이스를 제공해서 통신하게 해줌
- 운영체제가 제공하는 API 중에 하나, 시스템 콜의 일부

이 세상에 존재하는 프로세스는 무수히 많다. 그 중에 하나를 특정해서 통신하려면 주소가 필요한데 그것은 소켓 인터페이스의 주소다.
- IP주소를 통해서 프로세스가 동작하는 머신을 지정하고, 머신안에 프로세스는 포트번호가 필요하다.
    - ex) 아파트와 호수
    - 소켓을 지칭하는 법 : IP주소와 포트번호로 지칭한다.

클라이언트가(브라우저)가 웹 서버에 IP를 알아내는 법
1. 사용자가 사람들이 이해하기 쉬운 알파벳의 주소(ex, www.google.com)를 입력
2. DNS를 통해서 IP주소를 반환한다.

웹 브라우저에서 서버의 알파벳 주소를 입력하면 포트번호 80을 붙여준다. 만약 접속하고자 하는 서버의 포트가 777번 포트이면 주소:777 이런식으로 입력해야 한다.

### Web과 HTTP

HTTP(HyperText transfer Protocol)
- HyperText : 텍스트 중간 중간에 링크가 있음(그림, 동영상 링크)
- Transfer : 전송
- Protocol : 프로토콜
- request와 response로 이루어짐
- request : 클라이언트가 요청
- response: 서버가 응답

HTTP는 TCP기반이다.
- 메시지가 유실되지 않음
- UDP보다 비싸다.
- 서버와 클라이언트 사이에서  통신하기 위해서는 TCP 커넥션이 맺어져야 한다.
    - Request, Response 이전에 커넥션이 맺어져야 함


HTTP는 Stateless(상태가 없음)다. 
- 요청과 응답 이후에 서버는 어떠한 Request도 기억하지 않음
- 서버는 들어온 요청에 대해서만 응답해주고 끝임(기억하지 않음)

Non-Persistent HTTP
- html 파일에 이미지나 영상이 있는게 아니라 그에 대한 링크가 있음
    - 텍스트 사이에 링크가 있다.
- html 파일 가져오고, 각 링크를 가져올 때마다 TCP 커넥션을 맺고 끊는다.
- 즉 여러 오브젝트를 받아오려면 여러번의 TCP 연결이 필요하다.

Persistent HTTP
- 여러 오브젝트가 하나의 TCP 연결에 보내진다.

HTTP request message
- HTTP 메시지의 두 타입 : request, response
- HTTP request message
    - ASCII (human-readable format)
- request line(GET, POST, HEAD 등의 명령어)
- header lines
- 헤더 라인이 끝났다는것을 \r\n(캐리지 리턴)으로 알려준다.
    - 헤더라인 바로 아래줄에 \r\n을 추가한것임

HTTP response message
- status line
    - HTTP 버전, 상태코드, 상태 문구 HTTP/1.1 200 OK
- header lines
- 헤더 라인의 캐리지 리턴 다음 요청한 데이터에 대한 응답 데이터가 온다.

HTTP는 stateless이기 때문에 Cookie가 등장함
- 웹 브라우저에서 주소를 쳤을 때 웹 브라우저에 그 주소에 대한 쿠키가 없으면 그냥 요청을 한다. 서버는 쿠키를 전달한다. set-cookie(response 헤더에 설정), 이후에 서버와 통신할 때는 쿠키를 전달한다.(request 헤더에 쿠키)
- 쿠키 사용 예
    - 쇼핑 카트
    - 추천
    - 유전 세션 상태